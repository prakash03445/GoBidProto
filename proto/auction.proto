syntax = "proto3";

package gobid;

option go_package = "./gen/go";

service AuctionService {
    rpc AddProduct(Product) returns (ProductResponse);

    rpc Join(JoinRequest) returns (stream BidUpdate);

    rpc PlaceBid(BidRequest) returns (BidResponse);

    rpc GetProducts(Empty) returns (ProductListResponse);
}

message Empty {}

message Product {
    string product_id = 1;
    string name = 2;
    string description = 3;
    double starting_price = 4;
}

message ProductResponse {
    bool success = 1;
    string message = 2;
}

message JoinRequest {
    string user_id = 1;
    string username = 2; 
    string product_id = 3;
}

message BidRequest {
    string user_id = 1;
    string product_id = 2;
    double amount = 3;
}

message BidResponse {
    bool success = 1;
    string message = 2;
}

message BidUpdate {
    string highest_bidder_name = 1;
    double highest_amount = 2;
    string product_id = 3;
    bool auction_closed = 4;
}

message ProductListResponse {
    repeated Product product = 1;
}